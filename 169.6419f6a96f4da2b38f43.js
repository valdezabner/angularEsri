(window.webpackJsonp=window.webpackJsonp||[]).push([[169],{KgD9:function(e,t,n){"use strict";n.r(t),n.d(t,"destroyContext",function(){return w}),n.d(t,"dracoDecompressPointCloudData",function(){return d}),n.d(t,"filterObbsForModifications",function(){return h}),n.d(t,"filterObbsForModificationsSync",function(){return j}),n.d(t,"initialize",function(){return I}),n.d(t,"interpretObbModificationResults",function(){return _}),n.d(t,"process",function(){return l}),n.d(t,"setLegacySchema",function(){return g}),n.d(t,"setModifications",function(){return p}),n.d(t,"setModificationsSync",function(){return A}),n.d(t,"test",function(){return F});var r=n("HaE+"),o=n("ohva"),i=n("srIe"),s=n("ss0y");function f(e){return Object(s.a)(`esri/libs/i3s/${e}`)}let u,c,a;function l(e){return b.apply(this,arguments)}function b(){return(b=Object(r.a)(function*(e){yield I();const t=[e.geometryBuffer];return{result:L(e,t),transferList:t}})).apply(this,arguments)}function d(e){return y.apply(this,arguments)}function y(){return(y=Object(r.a)(function*(e){var t;yield I();const n=[e.geometryBuffer],{geometryBuffer:r}=e,i=r.byteLength,s=a._malloc(i),f=new Uint8Array(a.HEAPU8.buffer,s,i);f.set(new Uint8Array(r));const u=a.dracoDecompressPointCloudData(s,f.byteLength);if(a._free(s),u.error.length>0)throw`i3s.wasm: ${u.error}`;const c=(null==(t=u.featureIds)?void 0:t.length)>0?Object(o.m)(u.featureIds):null,l=Object(o.m)(u.positions);return c&&n.push(c.buffer),n.push(l.buffer),{result:{positions:l,featureIds:c},transferList:n}})).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return(m=Object(r.a)(function*(e){yield I(),j(e);const t={buffer:e.buffer};return{result:t,transferList:[t.buffer]}})).apply(this,arguments)}function p(e){return E.apply(this,arguments)}function E(){return(E=Object(r.a)(function*(e){yield I(),A(e)})).apply(this,arguments)}function g(e){return O.apply(this,arguments)}function O(){return(O=Object(r.a)(function*(e){yield I(),a.setLegacySchema(e.context,e.jsonSchema)})).apply(this,arguments)}function w(e){P(e)}function A(e){const t=e.modifications,n=a._malloc(8*t.length),r=new Float64Array(a.HEAPU8.buffer,n,t.length);for(let o=0;o<t.length;++o)r[o]=t[o];a.setModifications(e.context,n,t.length,e.isGeodetic),a._free(n)}function L(e,t){if(!a)return null;const{context:n,localOrigin:r,globalTrafo:s,mbs:f,obb:u,elevationOffset:c,geometryBuffer:l,geometryDescriptor:b,indexToVertexProjector:d,vertexToRenderProjector:y}=e,h=a._malloc(l.byteLength),m=a._malloc(33*Float64Array.BYTES_PER_ELEMENT),p=new Uint8Array(a.HEAPU8.buffer,h,l.byteLength);p.set(new Uint8Array(l));const E=new Float64Array(a.HEAPU8.buffer,m,33);T(E,r);let g=E.byteOffset+3*E.BYTES_PER_ELEMENT,O=new Float64Array(E.buffer,g);T(O,s),g+=16*E.BYTES_PER_ELEMENT,O=new Float64Array(E.buffer,g),T(O,f),g+=4*E.BYTES_PER_ELEMENT,Object(i.i)(u)&&(O=new Float64Array(E.buffer,g),T(O,u.center),g+=3*E.BYTES_PER_ELEMENT,O=new Float64Array(E.buffer,g),T(O,u.halfSize),g+=3*E.BYTES_PER_ELEMENT,O=new Float64Array(E.buffer,g),T(O,u.quaternion));const w=b,A={isDraco:!1,isLegacy:!1,color:e.layouts.some(e=>e.some(e=>"color"===e.name)),normal:e.needNormals&&e.layouts.some(e=>e.some(e=>"normalCompressed"===e.name)),uv0:e.layouts.some(e=>e.some(e=>"uv0"===e.name)),uvRegion:e.layouts.some(e=>e.some(e=>"uvRegion"===e.name)),featureIndex:w.featureIndex},L=a.process(n,!!e.obb,h,p.byteLength,w,A,m,c,d,y,e.normalReferenceFrame);if(a._free(m),a._free(h),L.error.length>0)throw`i3s.wasm: ${L.error}`;if(L.discarded)return null;const _=L.componentOffsets.length>0?Object(o.m)(L.componentOffsets):null,j=L.featureIds.length>0?Object(o.m)(L.featureIds):null,P=Object(o.m)(L.interleavedVertedData).buffer,I=1===L.indicesType?Object(o.m)(new Uint16Array(L.indices.buffer,L.indices.byteOffset,L.indices.byteLength/2)):Object(o.m)(new Uint32Array(L.indices.buffer,L.indices.byteOffset,L.indices.byteLength/4)),F=Object(o.m)(L.positions),M=1===L.positionIndicesType?Object(o.m)(new Uint16Array(L.positionIndices.buffer,L.positionIndices.byteOffset,L.positionIndices.byteLength/2)):Object(o.m)(new Uint32Array(L.positionIndices.buffer,L.positionIndices.byteOffset,L.positionIndices.byteLength/4)),v={layout:e.layouts[0],interleavedVertexData:P,indices:I,hasColors:L.hasColors,hasModifications:L.hasModifications,positionData:{data:F,indices:M}};return j&&t.push(j.buffer),_&&t.push(_.buffer),t.push(P),t.push(I.buffer),t.push(F.buffer),t.push(M.buffer),{componentOffsets:_,featureIds:j,transformedGeometry:v,obb:L.obb}}function _(e){return 0===e?0:1===e?1:2===e?2:3}function j(e){const{context:t,buffer:n}=e,r=a._malloc(n.byteLength),o=n.byteLength/Float64Array.BYTES_PER_ELEMENT,i=new Float64Array(a.HEAPU8.buffer,r,o),s=new Float64Array(n);i.set(s),a.filterOBBs(t,r,o),s.set(i),a._free(r)}function P(e){a&&a.destroy(e)}function T(e,t){for(let n=0;n<t.length;++n)e[n]=t[n]}function I(){return a?Promise.resolve():(c||(c=(u||(u=new Promise(e=>n.e(90).then(n.bind(null,"ilXH")).then(function(e){return e.i}).then(({default:t})=>{const n=t({locateFile:f,onRuntimeInitialized:()=>e(n)});delete n.then})).catch(e=>Promise.reject(e))),u).then(e=>{a=e,c=null})),c)}const F={transform:L,destroy:P}}}]);