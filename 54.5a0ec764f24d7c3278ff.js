(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{"64Oa":function(e,t,i){"use strict";i.r(t);var r=i("HaE+"),n=i("srIe"),s=i("6S2I"),o=i("zlDU"),l=i("KLE9"),u=i("kYAx"),a=i("xk++"),c=i("Hu/a"),f=i("Klsb"),h=i("q7ja"),d=i("DJok");const p=s.a.getLogger("esri.views.2d.layers.features.support.whereUtils"),m={getAttribute:(e,t)=>e.field(t)};function y(){return(y=Object(r.a)(function*(e,t){const r=yield i.e(7).then(i.bind(null,"ZqIb"));try{const i=r.WhereClause.create(e,t);if(!i.isStandardized){const e=new o.a("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",i);p.error(e)}return e=>{const t=e.readArcadeFeature();return i.testFeature(t,m)}}catch(n){return p.warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",e),e=>!0}})).apply(this,arguments)}const b=s.a.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter");t.default=class{constructor(e){this._geometryBounds=Object(u.e)(),this._idToVisibility=new Map,this._serviceInfo=e}get hash(){return this._hash}check(e){return this._applyFilter(e)}clear(){const e=this._resetAllHiddenIds();return this.update(),{show:e,hide:[]}}invalidate(){this._idToVisibility.forEach((e,t)=>{this._idToVisibility.set(t,0)})}setKnownIds(e){for(const t of e)this._idToVisibility.set(t,1)}setTrue(e){const t=[],i=[],r=new Set(e);return this._idToVisibility.forEach((e,n)=>{const s=!!(1&this._idToVisibility.get(n)),o=r.has(n);!s&&o?t.push(n):s&&!o&&i.push(n),this._idToVisibility.set(n,o?3:0)}),{show:t,hide:i}}createQuery(){const{geometry:e,spatialRel:t,where:i,timeExtent:r,objectIds:n}=this;return a.a.fromJSON({geometry:e,spatialRel:t,where:i,timeExtent:r,objectIds:n})}update(e,t){var i=this;return Object(r.a)(function*(){i._hash=JSON.stringify(e);const r=yield Object(c.e)(e,null,t);yield Promise.all([i._setGeometryFilter(r),i._setIdFilter(r),i._setAttributeFilter(r),i._setTimeFilter(r)])})()}_setAttributeFilter(e){var t=this;return Object(r.a)(function*(){if(!e||!e.where)return t._clause=null,void(t.where=null);t._clause=yield function(e,t){return y.apply(this,arguments)}(e.where,t._serviceInfo.fieldsIndex),t.where=e.where})()}_setIdFilter(e){this._idsToShow=e&&e.objectIds&&new Set(e.objectIds),this._idsToHide=e&&e.hiddenIds&&new Set(e.hiddenIds),this.objectIds=e&&e.objectIds}_setGeometryFilter(e){var t=this;return Object(r.a)(function*(){if(!e||!e.geometry)return t._spatialQueryOperator=null,t.geometry=null,void(t.spatialRel=null);const i=e.geometry,r=e.spatialRel||"esriSpatialRelIntersects",n=yield Object(f.c)(r,i,t._serviceInfo.geometryType,t._serviceInfo.hasZ,t._serviceInfo.hasM);Object(l.a)(t._geometryBounds,i),t._spatialQueryOperator=n,t.geometry=i,t.spatialRel=r})()}_setTimeFilter(e){if(this.timeExtent=this._timeOperator=null,e&&e.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=e.timeExtent,this._timeOperator=Object(h.b)(this._serviceInfo.timeInfo,e.timeExtent,d.b);else{const t=new o.a("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",e.timeExtent);b.error(t)}}_applyFilter(e){return this._filterByGeometry(e)&&this._filterById(e)&&this._filterByTime(e)&&this._filterByExpression(e)}_filterByExpression(e){return!this.where||this._clause(e)}_filterById(e){return(!this._idsToHide||!this._idsToHide.size||!this._idsToHide.has(e.getObjectId()))&&(!this._idsToShow||!this._idsToShow.size||this._idsToShow.has(e.getObjectId()))}_filterByGeometry(e){if(!this.geometry)return!0;const t=e.readHydratedGeometry();return!!t&&this._spatialQueryOperator(t)}_filterByTime(e){return!Object(n.i)(this._timeOperator)||this._timeOperator(e)}_resetAllHiddenIds(){const e=[];return this._idToVisibility.forEach((t,i)=>{1&t||(this._idToVisibility.set(i,1),e.push(i))}),e}}},"Hu/a":function(e,t,i){"use strict";i.d(t,"a",function(){return m}),i.d(t,"b",function(){return N}),i.d(t,"c",function(){return _}),i.d(t,"d",function(){return I}),i.d(t,"e",function(){return R}),i.d(t,"f",function(){return j});var r=i("HaE+"),n=i("srIe"),s=i("+opI"),o=i("f4Nx"),l=i("+NQI"),u=i("qatw"),a=i("gEht"),c=i("qNUd"),f=i("gVKr"),h=i("ZlUD"),d=(i("2X7Z"),i("HsO1"));const p=new s.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),m=Object.freeze({}),y=new f.a,b=new f.a,O=new f.a,g={esriGeometryPoint:h.m,esriGeometryPolyline:h.o,esriGeometryPolygon:h.n,esriGeometryMultipoint:h.l};function j(e,t,i,r=e.hasZ,n=e.hasM){const s=e.hasZ&&r,o=e.hasM&&n;if(i){const l=Object(h.u)(O,t,e.hasZ,e.hasM,"esriGeometryPoint",i,r,n);return Object(h.m)(l,s,o)}return Object(h.m)(t,s,o)}function _(e,t,i,r,n,s,o=t,l=i){const u=t&&o,a=i&&l,c=r?"coords"in r?r:r.geometry:null;if(!c)return null;if(n){let r=Object(h.q)(b,c,t,i,e,n,o,l);return s&&(r=Object(h.u)(O,r,u,a,e,s)),g[e](r,u,a)}if(s){const r=Object(h.u)(O,c,t,i,e,s,o,l);return g[e](r,u,a)}return Object(h.x)(y,c,t,i,o,l),g[e](y,u,a)}function I(e,t,i){return S.apply(this,arguments)}function S(){return(S=Object(r.a)(function*(e,t,i){const{outFields:r,orderByFields:n,groupByFieldsForStatistics:s,outStatistics:o}=e;if(r)for(let l=0;l<r.length;l++)r[l]=r[l].trim();if(n)for(let l=0;l<n.length;l++)n[l]=n[l].trim();if(s)for(let l=0;l<s.length;l++)s[l]=s[l].trim();if(o)for(let l=0;l<o.length;l++)o[l].onStatisticField&&(o[l].onStatisticField=o[l].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),R(e,t,i)})).apply(this,arguments)}function R(e,t,i){return w.apply(this,arguments)}function w(){return(w=Object(r.a)(function*(e,t,i){if(!e)return null;let{where:r}=e;if(e.where=r=r&&r.trim(),(!r||/^1 *= *1$/.test(r)||t&&t===r)&&(e.where=null),!e.geometry)return e;let s=yield v(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;s=Object(l.a)(s),s.spatialReference=t}e.geometry=s,yield Object(d.a)(s.spatialReference,i);const o=(yield Object(c.a)(Object(u.a)(s)))[0];if(Object(n.h)(o))throw m;const a=o.toJSON(),f=yield Object(d.b)(a,a.spatialReference,i);if(!f)throw m;return f.spatialReference=i,e.geometry=f,e})).apply(this,arguments)}function v(e){return M.apply(this,arguments)}function M(){return(M=Object(r.a)(function*(e){const{geometry:t,distance:i,units:r}=e;if(null==i||"vertexAttributes"in t)return t;const n=t.spatialReference,s=r?p.fromJSON(r):Object(a.f)(n),l=n&&(Object(o.f)(n)||Object(o.m)(n))?t:yield Object(d.a)(n,o.a).then(()=>Object(d.b)(t,o.a));return(yield T())(l.spatialReference,l,i,s)})).apply(this,arguments)}function T(){return x.apply(this,arguments)}function x(){return(x=Object(r.a)(function*(){return(yield Promise.all([i.e(12),i.e(0),i.e(23)]).then(i.bind(null,"AKzY"))).geodesicBuffer})).apply(this,arguments)}function N(e){return e&&E in e?JSON.parse(JSON.stringify(e,F)):e}const E="_geVersion",F=(e,t)=>e!==E?t:void 0},Klsb:function(e,t,i){"use strict";i.d(t,"a",function(){return M}),i.d(t,"b",function(){return w}),i.d(t,"c",function(){return R});var r=i("HaE+"),n=i("zlDU"),s=i("f4Nx"),o=i("IXLn"),l=i("PNY3"),u=i("qatw"),a=i("gVKr"),c=i("ZlUD");function f(e,t){return e?t?4:3:t?3:2}function h(e,t,i,r,n){if(!e)return!1;const s=f(t,i),{coords:o,lengths:l}=e;let u=!1,a=0;for(const c of l)u=d(u,o,s,a,c,r,n),a+=c*s;return u}function d(e,t,i,r,n,s,o){let l=e,u=r;for(let a=r,c=r+n*i;a<c;a+=i){u=a+i,u===c&&(u=r);const e=t[a],n=t[a+1],f=t[u],h=t[u+1];(n<o&&h>=o||h<o&&n>=o)&&e+(o-n)/(h-n)*(f-e)<s&&(l=!l)}return l}var p=i("HsO1"),m=i("Hu/a");const y="feature-store:unsupported-query",b={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},O={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},g={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},j={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function _(e){return!0===O[e]}function I(e){return!0===g[Object(u.c)(e)]}function S(e){return!0===j[e]}function R(e,t,r,n,s){if(Object(u.g)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=Object(c.g)(new a.a,t,!1,!1);return Promise.resolve(t=>function(e,t,i,r){return h(e,!1,!1,r.coords[0],r.coords[1])}(e,0,0,t))}if(Object(u.g)(t)&&"esriGeometryMultipoint"===r){const i=Object(c.g)(new a.a,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve(e=>function(e,t,i,r,n,s){const o=f(n,s),{coords:l,lengths:u}=r;if(!u)return!1;for(let a=0,c=0;a<u.length;a++,c+=o)if(!h(e,!1,!1,l[c],l[c+1]))return!1;return!0}(i,0,0,e,n,s))}if(Object(u.d)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve(e=>Object(o.e)(t,Object(m.c)(r,n,s,e)));if(Object(u.d)(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Promise.resolve(e=>Object(o.d)(t,Object(m.c)(r,n,s,e)));if(Object(u.d)(t)&&"esriSpatialRelIntersects"===e){const e=Object(l.b)(r);return Promise.resolve(i=>e(t,Object(m.c)(r,n,s,i)))}return Promise.all([i.e(12),i.e(0),i.e(23)]).then(i.bind(null,"AKzY")).then(i=>{const o=i[b[e]].bind(null,t.spatialReference,t);return e=>o(Object(m.c)(r,n,s,e))})}function w(e,t,i){return v.apply(this,arguments)}function v(){return(v=Object(r.a)(function*(e,t,i){const{spatialRel:r,geometry:o}=e;if(o){if(!_(r))throw new n.a(y,"Unsupported query spatial relationship",{query:e});if(Object(s.i)(o.spatialReference)&&Object(s.i)(i)){if(!I(o))throw new n.a(y,"Unsupported query geometry type",{query:e});if(!S(t))throw new n.a(y,"Unsupported layer geometry type",{query:e});if(e.outSR)return Object(p.a)(e.geometry&&e.geometry.spatialReference,e.outSR)}}})).apply(this,arguments)}function M(e){if(Object(u.d)(e))return!0;if(Object(u.g)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}},QmHG:function(e,t,i){"use strict";i.d(t,"a",function(){return b}),i.d(t,"b",function(){return n}),i.d(t,"c",function(){return d}),i.d(t,"d",function(){return y}),i.d(t,"e",function(){return o}),i.d(t,"f",function(){return u}),i.d(t,"g",function(){return l}),i.d(t,"h",function(){return p}),i.d(t,"i",function(){return s}),i.d(t,"j",function(){return h}),i.d(t,"k",function(){return f}),i.d(t,"l",function(){return c}),i.d(t,"m",function(){return a});var r=i("srIe");function n(e=O){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function s(e,t,i,r,s,o,l=n()){return l[0]=e,l[1]=t,l[2]=i,l[3]=r,l[4]=s,l[5]=o,l}function o(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function l(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function u(e,t,i){const r=t.length;let n=e[0],s=e[1],o=e[2],l=e[3],u=e[4],a=e[5];if(i)for(let c=0;c<r;c++){const e=t[c];n=Math.min(n,e[0]),s=Math.min(s,e[1]),o=Math.min(o,e[2]),l=Math.max(l,e[0]),u=Math.max(u,e[1]),a=Math.max(a,e[2])}else for(let c=0;c<r;c++){const e=t[c];n=Math.min(n,e[0]),s=Math.min(s,e[1]),l=Math.max(l,e[0]),u=Math.max(u,e[1])}e[0]=n,e[1]=s,e[2]=o,e[3]=l,e[4]=u,e[5]=a}function a(e,t=[0,0,0]){return t[0]=function(e){return e[0]>=e[3]?0:e[3]-e[0]}(e),t[1]=function(e){return e[1]>=e[4]?0:e[4]-e[1]}(e),t[2]=function(e){return e[2]>=e[5]?0:e[5]-e[2]}(e),t}function c(e,t,i=e){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i!==e&&(i[3]=e[3],i[4]=e[4],i[5]=e[5]),i}function f(e,t,i=e){return i[3]=t[0],i[4]=t[1],i[5]=t[2],i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),e}function h(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function d(e){return e?h(e,b):n(b)}function p(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function m(e){return 6===e.length}function y(e,t,i){if(Object(r.h)(e)||Object(r.h)(t))return e===t;if(!m(e)||!m(t))return!1;if(i){for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}i("OvF4"),i("kYAx");const b=[1/0,1/0,1/0,-1/0,-1/0,-1/0],O=[0,0,0,0,0,0];n()},q7ja:function(e,t,i){"use strict";function r(e,t){if(!e)return null;const i=t.featureAdapter,{startTimeField:r,endTimeField:n}=e;let s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(r&&n)t.forEach(e=>{const t=i.getAttribute(e,r),l=i.getAttribute(e,n);null==t||isNaN(t)||(s=Math.min(s,t)),null==l||isNaN(l)||(o=Math.max(o,l))});else{const e=r||n;t.forEach(t=>{const r=i.getAttribute(t,e);null==r||isNaN(r)||(s=Math.min(s,r),o=Math.max(o,r))})}return{start:s,end:o}}function n(e,t,i){if(!t||!e)return null;const{startTimeField:r,endTimeField:n}=e;if(!r&&!n)return null;const{start:s,end:o}=t;return null===s&&null===o?null:void 0===s&&void 0===o?()=>!1:r&&n?function(e,t,i,r,n){return null!=r&&null!=n?s=>{const o=e.getAttribute(s,t),l=e.getAttribute(s,i);return(null==o||o<=n)&&(null==l||l>=r)}:null!=r?t=>{const n=e.getAttribute(t,i);return null==n||n>=r}:null!=n?i=>{const r=e.getAttribute(i,t);return null==r||r<=n}:void 0}(i,r,n,s,o):function(e,t,i,r){return null!=i&&null!=r&&i===r?r=>e.getAttribute(r,t)===i:null!=i&&null!=r?n=>{const s=e.getAttribute(n,t);return s>=i&&s<=r}:null!=i?r=>e.getAttribute(r,t)>=i:null!=r?i=>e.getAttribute(i,t)<=r:void 0}(i,r||n,s,o)}i.d(t,"a",function(){return r}),i.d(t,"b",function(){return n})}}]);