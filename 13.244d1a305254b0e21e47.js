(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"Hu/a":function(e,t,i){"use strict";i.d(t,"a",function(){return p}),i.d(t,"b",function(){return Q}),i.d(t,"c",function(){return I}),i.d(t,"d",function(){return O}),i.d(t,"e",function(){return S}),i.d(t,"f",function(){return _});var r=i("HaE+"),s=i("srIe"),n=i("+opI"),a=i("f4Nx"),u=i("+NQI"),c=i("qatw"),o=i("gEht"),l=i("qNUd"),h=i("gVKr"),f=i("ZlUD"),d=(i("2X7Z"),i("HsO1"));const y=new n.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),p=Object.freeze({}),m=new h.a,g=new h.a,b=new h.a,x={esriGeometryPoint:f.m,esriGeometryPolyline:f.o,esriGeometryPolygon:f.n,esriGeometryMultipoint:f.l};function _(e,t,i,r=e.hasZ,s=e.hasM){const n=e.hasZ&&r,a=e.hasM&&s;if(i){const u=Object(f.u)(b,t,e.hasZ,e.hasM,"esriGeometryPoint",i,r,s);return Object(f.m)(u,n,a)}return Object(f.m)(t,n,a)}function I(e,t,i,r,s,n,a=t,u=i){const c=t&&a,o=i&&u,l=r?"coords"in r?r:r.geometry:null;if(!l)return null;if(s){let r=Object(f.q)(g,l,t,i,e,s,a,u);return n&&(r=Object(f.u)(b,r,c,o,e,n)),x[e](r,c,o)}if(n){const r=Object(f.u)(b,l,t,i,e,n,a,u);return x[e](r,c,o)}return Object(f.x)(m,l,t,i,a,u),x[e](m,c,o)}function O(e,t,i){return j.apply(this,arguments)}function j(){return(j=Object(r.a)(function*(e,t,i){const{outFields:r,orderByFields:s,groupByFieldsForStatistics:n,outStatistics:a}=e;if(r)for(let u=0;u<r.length;u++)r[u]=r[u].trim();if(s)for(let u=0;u<s.length;u++)s[u]=s[u].trim();if(n)for(let u=0;u<n.length;u++)n[u]=n[u].trim();if(a)for(let u=0;u<a.length;u++)a[u].onStatisticField&&(a[u].onStatisticField=a[u].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),S(e,t,i)})).apply(this,arguments)}function S(e,t,i){return R.apply(this,arguments)}function R(){return(R=Object(r.a)(function*(e,t,i){if(!e)return null;let{where:r}=e;if(e.where=r=r&&r.trim(),(!r||/^1 *= *1$/.test(r)||t&&t===r)&&(e.where=null),!e.geometry)return e;let n=yield F(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;n=Object(u.a)(n),n.spatialReference=t}e.geometry=n,yield Object(d.a)(n.spatialReference,i);const a=(yield Object(l.a)(Object(c.a)(n)))[0];if(Object(s.h)(a))throw p;const o=a.toJSON(),h=yield Object(d.b)(o,o.spatialReference,i);if(!h)throw p;return h.spatialReference=i,e.geometry=h,e})).apply(this,arguments)}function F(e){return w.apply(this,arguments)}function w(){return(w=Object(r.a)(function*(e){const{geometry:t,distance:i,units:r}=e;if(null==i||"vertexAttributes"in t)return t;const s=t.spatialReference,n=r?y.fromJSON(r):Object(o.f)(s),u=s&&(Object(a.f)(s)||Object(a.m)(s))?t:yield Object(d.a)(s,a.a).then(()=>Object(d.b)(t,a.a));return(yield A())(u.spatialReference,u,i,n)})).apply(this,arguments)}function A(){return v.apply(this,arguments)}function v(){return(v=Object(r.a)(function*(){return(yield Promise.all([i.e(12),i.e(0),i.e(23)]).then(i.bind(null,"AKzY"))).geodesicBuffer})).apply(this,arguments)}function Q(e){return e&&T in e?JSON.parse(JSON.stringify(e,M)):e}const T="_geVersion",M=(e,t)=>e!==T?t:void 0},Klsb:function(e,t,i){"use strict";i.d(t,"a",function(){return w}),i.d(t,"b",function(){return R}),i.d(t,"c",function(){return S});var r=i("HaE+"),s=i("zlDU"),n=i("f4Nx"),a=i("IXLn"),u=i("PNY3"),c=i("qatw"),o=i("gVKr"),l=i("ZlUD");function h(e,t){return e?t?4:3:t?3:2}function f(e,t,i,r,s){if(!e)return!1;const n=h(t,i),{coords:a,lengths:u}=e;let c=!1,o=0;for(const l of u)c=d(c,a,n,o,l,r,s),o+=l*n;return c}function d(e,t,i,r,s,n,a){let u=e,c=r;for(let o=r,l=r+s*i;o<l;o+=i){c=o+i,c===l&&(c=r);const e=t[o],s=t[o+1],h=t[c],f=t[c+1];(s<a&&f>=a||f<a&&s>=a)&&e+(a-s)/(f-s)*(h-e)<n&&(u=!u)}return u}var y=i("HsO1"),p=i("Hu/a");const m="feature-store:unsupported-query",g={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},b={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},x={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},_={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function I(e){return!0===b[e]}function O(e){return!0===x[Object(c.c)(e)]}function j(e){return!0===_[e]}function S(e,t,r,s,n){if(Object(c.g)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=Object(l.g)(new o.a,t,!1,!1);return Promise.resolve(t=>function(e,t,i,r){return f(e,!1,!1,r.coords[0],r.coords[1])}(e,0,0,t))}if(Object(c.g)(t)&&"esriGeometryMultipoint"===r){const i=Object(l.g)(new o.a,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve(e=>function(e,t,i,r,s,n){const a=h(s,n),{coords:u,lengths:c}=r;if(!c)return!1;for(let o=0,l=0;o<c.length;o++,l+=a)if(!f(e,!1,!1,u[l],u[l+1]))return!1;return!0}(i,0,0,e,s,n))}if(Object(c.d)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve(e=>Object(a.e)(t,Object(p.c)(r,s,n,e)));if(Object(c.d)(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Promise.resolve(e=>Object(a.d)(t,Object(p.c)(r,s,n,e)));if(Object(c.d)(t)&&"esriSpatialRelIntersects"===e){const e=Object(u.b)(r);return Promise.resolve(i=>e(t,Object(p.c)(r,s,n,i)))}return Promise.all([i.e(12),i.e(0),i.e(23)]).then(i.bind(null,"AKzY")).then(i=>{const a=i[g[e]].bind(null,t.spatialReference,t);return e=>a(Object(p.c)(r,s,n,e))})}function R(e,t,i){return F.apply(this,arguments)}function F(){return(F=Object(r.a)(function*(e,t,i){const{spatialRel:r,geometry:a}=e;if(a){if(!I(r))throw new s.a(m,"Unsupported query spatial relationship",{query:e});if(Object(n.i)(a.spatialReference)&&Object(n.i)(i)){if(!O(a))throw new s.a(m,"Unsupported query geometry type",{query:e});if(!j(t))throw new s.a(m,"Unsupported layer geometry type",{query:e});if(e.outSR)return Object(y.a)(e.geometry&&e.geometry.spatialReference,e.outSR)}}})).apply(this,arguments)}function w(e){if(Object(c.d)(e))return!0;if(Object(c.g)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}},QmHG:function(e,t,i){"use strict";i.d(t,"a",function(){return g}),i.d(t,"b",function(){return s}),i.d(t,"c",function(){return d}),i.d(t,"d",function(){return m}),i.d(t,"e",function(){return a}),i.d(t,"f",function(){return c}),i.d(t,"g",function(){return u}),i.d(t,"h",function(){return y}),i.d(t,"i",function(){return n}),i.d(t,"j",function(){return f}),i.d(t,"k",function(){return h}),i.d(t,"l",function(){return l}),i.d(t,"m",function(){return o});var r=i("srIe");function s(e=b){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function n(e,t,i,r,n,a,u=s()){return u[0]=e,u[1]=t,u[2]=i,u[3]=r,u[4]=n,u[5]=a,u}function a(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function u(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function c(e,t,i){const r=t.length;let s=e[0],n=e[1],a=e[2],u=e[3],c=e[4],o=e[5];if(i)for(let l=0;l<r;l++){const e=t[l];s=Math.min(s,e[0]),n=Math.min(n,e[1]),a=Math.min(a,e[2]),u=Math.max(u,e[0]),c=Math.max(c,e[1]),o=Math.max(o,e[2])}else for(let l=0;l<r;l++){const e=t[l];s=Math.min(s,e[0]),n=Math.min(n,e[1]),u=Math.max(u,e[0]),c=Math.max(c,e[1])}e[0]=s,e[1]=n,e[2]=a,e[3]=u,e[4]=c,e[5]=o}function o(e,t=[0,0,0]){return t[0]=function(e){return e[0]>=e[3]?0:e[3]-e[0]}(e),t[1]=function(e){return e[1]>=e[4]?0:e[4]-e[1]}(e),t[2]=function(e){return e[2]>=e[5]?0:e[5]-e[2]}(e),t}function l(e,t,i=e){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i!==e&&(i[3]=e[3],i[4]=e[4],i[5]=e[5]),i}function h(e,t,i=e){return i[3]=t[0],i[4]=t[1],i[5]=t[2],i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),e}function f(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function d(e){return e?f(e,g):s(g)}function y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function p(e){return 6===e.length}function m(e,t,i){if(Object(r.h)(e)||Object(r.h)(t))return e===t;if(!p(e)||!p(t))return!1;if(i){for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}i("OvF4"),i("kYAx");const g=[1/0,1/0,1/0,-1/0,-1/0,-1/0],b=[0,0,0,0,0,0];s()},ZBG3:function(e,t,i){"use strict";var r=i("HaE+"),s=i("f/qv"),n=i("srIe"),a=i("zlDU"),u=i("f4Nx"),c=i("KLE9"),o=i("qatw"),l=i("gEht"),h=i("kYAx"),f=i("MG+P"),d=i("qNUd"),y=i("rvq7"),p=i("gLc9"),m=i("qUyK"),g=i("QmHG"),b=i("HsO1"),x=i("1/KW"),_=i("ZqIb");const I=new class{constructor(e,t){this._cache=new x.a(e),this._invalidCache=new x.a(t)}get(e,t){const i=`${t.uid}:${e}`,r=this._cache.get(i);if(r)return r;if(void 0!==this._invalidCache.get(i))return null;try{const r=_.WhereClause.create(e,t);return this._cache.put(i,r),r}catch{return this._invalidCache.put(i,null),null}}}(50,500),O="feature-store:unsupported-query",j=" as ",S=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function R(e,t){return e?I.get(e,t):null}function F(e,t,i,r=!0){const s=[];for(const u of t)if("*"!==u&&!e.has(u))if(r){const t=w(u);try{const i=R(t,e);if(!i)throw new a.a(O,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new a.a(O,"expression is not standard",{clause:i});F(e,i.fieldNames,"expression contains missing fields")}catch(n){const e=n&&n.details;if(e&&(e.clause||e.where))throw n;e&&e.missingFields?s.push(...e.missingFields):s.push(u)}}else s.push(u);if(s.length)throw new a.a(O,i,{missingFields:s})}function w(e){return e.split(j)[0]}function A(e,t){const i=t.get(e);return!!i&&!S.has(i.type)}var v=i("Hu/a"),Q=i("Klsb"),T=i("q7ja"),M=i("ZlUD"),N=i("AIxD"),P=class{constructor(e,t,i){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=i,this.featureAdapter=t;const r=e.outFields;if(r&&-1===r.indexOf("*")){this.outFields=r;let e=0;for(const t of r){const r=w(t),s=this.fieldsIndex.get(r),n=s?null:R(r,i),a=s?s.name:t.split(j)[1]||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:a,clause:n})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach(e=>this.getAttributes(e)),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,i){const r=i?i.name:t;let s=null;return this._fieldDataCache.has(r)?s=this._fieldDataCache.get(r).clause:i||(s=R(t,this.fieldsIndex),this._fieldDataCache.set(r,{alias:r,clause:s})),i?this.featureAdapter.getAttribute(e,r):s.calculateValue(e,this.featureAdapter)}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:R(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:R(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const i={};for(const r of t){const{alias:t,clause:s}=this._fieldDataCache.get(r);i[t]=s?s.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return i}_processAttributesForDistinctValues(e){if(Object(n.h)(e)||!this.returnDistinctValues)return e;const t=this.outFields,i=[];if(t)for(const n of t){const{alias:t}=this._fieldDataCache.get(n);i.push(e[t])}else for(const n in e)i.push(e[n]);const r=`${(t||["*"]).join(",")}=${i.join(",")}`;let s=this._returnDistinctMap.get(r)||0;return this._returnDistinctMap.set(r,++s),s>1?null:e}};function E(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function C(e,t,i){return(i?e>t:e<t)?-1:(i?e<t:e>t)?1:0}function G(e,t,i){return i?t-e:e-t}function q(e,t,i,r){if(i&&"esriFieldTypeDate"===i.type){const i=new Date(e).getTime(),s=new Date(t).getTime();if(!isNaN(i)&&!isNaN(s))return G(i,s,r)}if("number"==typeof e&&"number"==typeof t)return G(e,t,r);if("string"==typeof e&&"string"==typeof t){const s=e.toUpperCase(),n=t.toUpperCase();return!i||"esriFieldTypeGUID"!==i.type&&"esriFieldTypeGlobalID"!==i.type?C(s,n,r):C(E(s),E(n),r)}return r?1:-1}class V{constructor(e,t,i){this.items=e,this.queryGeometry=t,this.definitionExpression=i.definitionExpression,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.fieldsIndex=i.fieldsIndex,this.timeInfo=i.timeInfo,this.featureAdapter=i.featureAdapter,this.aggregateAdapter=i.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new P(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:i,having:r}=e;if(!(null==i?void 0:i.length))return 1;const s=new Map,n=new Map,a=new Set,u=e.outStatistics;for(const c of u){const{statisticType:e}=c,u="exceedslimit"!==e?c.onStatisticField:void 0;if(!n.has(u)){const e=[];for(const r of i){const i=this._getAttributeValues(t,r,s);e.push(i)}n.set(u,this._calculateUniqueValues(e))}const o=n.get(u);for(const i in o){const{data:e,items:s}=o[i],n=e.join(",");r&&!t.validateItems(s,r)||a.add(n)}}return a.size}createQueryResponse(e){let t;return t=e.outStatistics?e.outStatistics.some(e=>"exceedslimit"===e.statisticType)?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(t.queryGeometry=Object(u.i)(e.outSR)&&!Object(u.c)(this.queryGeometry.spatialReference,e.outSR)?Object(v.b)({spatialReference:e.outSR,...Object(b.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):Object(v.b)({spatialReference:e.outSR,...this.queryGeometry})),t}createSnappingResponse(e,t){const i=this.featureAdapter,r=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:s,y:n}=e.point,a="number"==typeof e.distance?e.distance:e.distance.x,u="number"==typeof e.distance?e.distance:e.distance.y,c={candidates:[]},o="esriGeometryPolygon"===this.geometryType,l=this.getPointCreator(e.point,this.spatialReference,t);for(const h of this.items){const t=i.getGeometry(h);if(!t)continue;const{coords:f,lengths:d}=t;if(1&e.types){let e=0;for(let t=0;t<d.length;t++){const o=d[t];for(let t=0;t<o;t++,e+=r){const d=f[e],y=f[e+1];if(t!==o-1){const t=f[e+r],o=f[e+r+1],{x:p,y:m}=D(s,n,d,y,t,o),g=(s-p)/a,b=(n-m)/u,x=g*g+b*b;x<=1&&c.candidates.push({type:"edge",objectId:i.getObjectId(h),distance:Math.sqrt(x),target:l(p,m),start:l(d,y),end:l(t,o)})}}}}if(2&e.types){const e=o?f.length-r:f.length;for(let t=0;t<e;t+=r){const e=f[t],r=f[t+1],o=(s-e)/a,d=(n-r)/u,y=o*o+d*d;y<=1&&c.candidates.push({type:"vertex",objectId:i.getObjectId(h),distance:Math.sqrt(y),target:l(e,r)})}}}return c.candidates.sort((e,t)=>e.distance-t.distance),c}getPointCreator(e,t,i){const r=Object(n.i)(i)&&!Object(u.c)(t,i)?e=>Object(b.b)(e,t,i):e=>e;return null!=e.z&&null!=e.m?(t,i)=>r({x:t,y:i,z:e.z,m:e.m}):null!=e.z?(t,i)=>r({x:t,y:i,z:e.z}):null!=e.m?(t,i)=>r({x:t,y:i,m:e.m}):(e,t)=>r({x:e,y:t})}executeAttributesQuery(e){const t=R(e.where,this.fieldsIndex);if(!t)return Promise.resolve(this);if(t.isStandardized){let i=0;const r=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(r[i++]=e);const s=new V(r,this.queryGeometry,this);return s.definitionExpression=e.where,Promise.resolve(s)}return Promise.reject(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(e){if(!e.aggregateIds||!e.aggregateIds.length||Object(n.h)(this.aggregateAdapter))return Promise.resolve(this);const t=new Set;for(const r of e.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach(e=>t.add(e));const i=this.featureAdapter.getObjectId;return Promise.resolve(new V(this.items.filter(e=>t.has(i(e))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Promise.resolve(this);const t=new Set(e.objectIds),i=this.featureAdapter.getObjectId;return Promise.resolve(new V(this.items.filter(e=>t.has(i(e))),this.queryGeometry,this))}executeTimeQuery(e){const t=Object(T.b)(this.timeInfo,e.timeExtent,this.featureAdapter);if(!Object(n.i)(t))return Promise.resolve(this);const i=this.items.filter(t);return Promise.resolve(new V(i,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:i}=this.timeInfo,r=i||t,s=new Map,n=this.featureAdapter.getAttribute;for(const u of this.items){const t=n(u,e),i=n(u,r),a=s.get(t);(!a||i>n(a,r))&&s.set(t,u)}const a=Array.from(s.values());return Promise.resolve(new V(a,this.queryGeometry,this))}project(e){var t=this;return Object(r.a)(function*(){if(!e||Object(u.c)(t.spatialReference,e))return t;const i=t.featureAdapter,r=(yield Object(b.c)(t.items.map(e=>Object(v.c)(t.geometryType,t.hasZ,t.hasM,i.getGeometry(e))),t.spatialReference,e)).map((e,r)=>i.cloneWithGeometry(t.items[r],Object(M.d)(e,t.hasZ,t.hasM)));return new V(r,t.queryGeometry,{definitionExpression:t.definitionExpression,geometryType:t.geometryType,hasM:t.hasM,hasZ:t.hasZ,objectIdField:t.objectIdField,spatialReference:e,fieldsIndex:t.fieldsIndex,timeInfo:t.timeInfo,featureAdapter:t.featureAdapter})})()}_sortFeatures(e,t,i){if(e.length>1&&t&&t.length)for(const r of t.reverse()){const t=r.split(" "),s=t[0],n=this.fieldsIndex.get(s),a=t[1]&&"desc"===t[1].toLowerCase();e.sort((e,t)=>q(i(e,s,n),i(t,s,n),n,a))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:i,hasM:r,hasZ:s,objectIdField:n,spatialReference:a}=this,{outFields:u,outSR:c,quantizationParameters:o,resultRecordCount:l,resultOffset:h,returnZ:f,returnM:d}=e,y=null!=l&&t.length>(h||0)+l,p=u&&(u.indexOf("*")>-1?[...this.fieldsIndex.fields]:u.map(e=>this.fieldsIndex.get(e)));return{exceededTransferLimit:y,features:this._createFeatures(e,t),fields:p,geometryType:i,hasM:r&&d,hasZ:s&&f,objectIdFieldName:n,spatialReference:Object(v.b)(c||a),transform:o&&Object(N.c)(o)||null}}_createFeatures(e,t){const i=new P(e,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:s}=this,{orderByFields:n,quantizationParameters:a,returnGeometry:u,returnCentroid:c,maxAllowableOffset:o,resultOffset:l,resultRecordCount:h,returnZ:f=!1,returnM:d=!1}=e,y=s&&f,p=r&&d;let m=[],g=0;const b=[...t];if(this._sortFeatures(b,n,(e,t,r)=>i.getFieldValue(e,t,r)),u||c){const e=Object(N.c)(a);if(u&&!c)for(const t of b)m[g++]={attributes:i.getAttributes(t),geometry:Object(v.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),o,e,y,p)};else if(!u&&c)for(const t of b)m[g++]={attributes:i.getAttributes(t),centroid:Object(v.f)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of b)m[g++]={attributes:i.getAttributes(t),centroid:Object(v.f)(this,this.featureAdapter.getCentroid(t,this),e),geometry:Object(v.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),o,e,y,p)}}else for(const _ of b){const e=i.getAttributes(_);e&&(m[g++]={attributes:e})}const x=l||0;return null!=h&&(m=m.slice(x,Math.min(m.length,x+h))),m}_createExceedsLimitQueryResponse(e){let t=!1,i=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const n of e.outStatistics)if("exceedslimit"===n.statisticType){i=null!=n.maxPointCount?n.maxPointCount:Number.POSITIVE_INFINITY,r=null!=n.maxRecordCount?n.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=n.maxVertexCount?n.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>i;else if(this.items.length>r)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,i=this.featureAdapter;t=this.items.reduce((e,t)=>{const r=i.getGeometry(t);return e+(r&&r.coords.length||0)},0)/e>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}_createStatisticsQueryResponse(e){const t={attributes:{}},i=[],r=new Map,s=new Map,n=new Map,a=new Map,u=new P(e,this.featureAdapter,this.fieldsIndex),c=e.outStatistics,{groupByFieldsForStatistics:o,having:l,orderByFields:h}=e,f=o&&o.length,d=!!f,y=d&&o[0],p=d&&!this.fieldsIndex.get(y);for(const g of c){const{outStatisticFieldName:e,statisticType:c}=g,h=g,m="exceedslimit"!==c?g.onStatisticField:void 0,b="percentile_disc"===c||"percentile_cont"===c,x=d&&1===f&&(m===y||p)&&"count"===c;if(d){if(!n.has(m)){const e=[];for(const t of o){const i=this._getAttributeValues(u,t,r);e.push(i)}n.set(m,this._calculateUniqueValues(e,u.returnDistinctValues))}const t=n.get(m);for(const i in t){const{count:s,data:n,items:c,itemPositions:f}=t[i],d=n.join(",");if(!l||u.validateItems(c,l)){const t=a.get(d)||{attributes:{}};let i=null;if(x)i=s;else{const e=this._getAttributeValues(u,m,r),t=f.map(t=>e[t]);i=b&&"statisticParameters"in h?this._getPercentileValue(h,t):this._getStatisticValue(h,t)}t.attributes[e]=i,o.forEach((e,i)=>t.attributes[this.fieldsIndex.get(e)?e:`EXPR_${i+1}`]=n[i]),a.set(d,t)}}}else{const i=this._getAttributeValues(u,m,r);t.attributes[e]=b&&"statisticParameters"in h?this._getPercentileValue(h,i):this._getStatisticValue(h,i,s)}i.push({name:e,alias:e,type:"esriFieldTypeDouble"})}const m=d?Array.from(a.values()):[t];return this._sortFeatures(m,h,(e,t)=>e.attributes[t]),{fields:i,features:m}}_getStatisticValue(e,t,i){const{onStatisticField:r,statisticType:s}=e,n=i&&i.has(r)?i.get(r):this._calculateStatistics(t);return i&&i.set(r,n),n["var"===s?"variance":s]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:r,statisticType:s}=e,{value:n,orderBy:a}=r,u="desc"===a,c=this.fieldsIndex.get(i),o=[...t].filter(e=>null!=e).sort((e,t)=>q(e,t,c,u));return this._calculatePercentile(o,n,"percentile_disc"===s)}_getAttributeValues(e,t,i){if(i.has(t))return i.get(t);const r=this.fieldsIndex.get(t),s=this.items.map(i=>e.getFieldValue(i,t,r));return i.set(t,s),s}_calculateStatistics(e){let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=null,s=null,n=null,a=null;const u=[];let c=0;for(const o of e)"string"==typeof o?c++:null==o||isNaN(o)||(r+=o,t=Math.min(t,o),i=Math.max(i,o),u.push(o),c++);if(c){s=r/c;let e=0;for(const t of u)e+=(t-s)**2;a=c>1?e/(c-1):0,n=Math.sqrt(a)}else t=null,i=null;return{avg:s,count:c,max:i,min:t,stddev:n,sum:r,variance:a}}_calculateUniqueValues(e,t){const i={},r=this.items,s=r.length;for(let n=0;n<s;n++){const s=r[n],a=[];for(const t of e)a.push(t[n]);const u=a.join(",");t?null==i[u]&&(i[u]={count:1,data:a,items:[s],itemPositions:[n]}):null==i[u]?i[u]={count:1,data:a,items:[s],itemPositions:[n]}:(i[u].count++,i[u].items.push(s),i[u].itemPositions.push(n))}return i}_calculatePercentile(e,t,i){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];const r=(e.length-1)*t,s=Math.floor(r),n=s+1,a=r%1,u=e[s],c=e[n];return n>=e.length||i||"string"==typeof u||"string"==typeof c?u:u*(1-a)+c*a}}function D(e,t,i,r,s,n){const a=s-i,u=n-r,c=Math.min(1,Math.max(0,((e-i)*a+(t-r)*u)/(a*a+u*u)));return{x:i+a*c,y:r+u*c}}var z=V;const Z="feature-store:unsupported-query",k=new Set,B=new y.b(2e6);let U=0;const L=Object(g.b)(),Y=Object(g.b)();t.a=class{constructor(e){this.capabilities={query:m.a},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new y.a(U+++"$$",B)),this.fieldsIndex=new p.a(e.fields),e.scheduler&&e.task&&(this._frameQueue=new f.a,this._frameTask=e.scheduler.registerTask(e.task,e=>this._update(e),()=>this._frameQueue.length>0))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(v.b)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(T.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}executeQuery(e={},t){var i=this;return Object(r.a)(function*(){let r,n=Object(s.a)(e);try{n=yield i._schedule(()=>Object(v.d)(n,i.definitionExpression,i.spatialReference),t),n=yield i._reschedule(()=>i._checkQuerySupport(n),t),r=yield i._reschedule(()=>i._executeGeometryQuery(n,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(n),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(n),t),r=yield i._reschedule(()=>r.executeTimeQuery(n),t),r=yield i._reschedule(()=>r.executeAttributesQuery(n),t)}catch(a){if(a!==v.a)throw a;r=new z([],null,i)}return r.createQueryResponse(n)})()}executeQueryForCount(e={},t){var i=this;return Object(r.a)(function*(){let r,n=Object(s.a)(e);n.returnGeometry=!1,n.returnCentroid=!1,n.outSR=null;try{n=yield i._schedule(()=>Object(v.d)(n,i.definitionExpression,i.spatialReference),t),n=yield i._reschedule(()=>i._checkQuerySupport(n),t),r=yield i._reschedule(()=>i._executeGeometryQuery(n,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(n),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(n),t),r=yield i._reschedule(()=>r.executeTimeQuery(n),t),r=yield i._reschedule(()=>r.executeAttributesQuery(n),t)}catch(a){if(a!==v.a)throw a;return 0}return r.createQueryResponseForCount(n)})()}executeQueryForExtent(e={},t){var i=this;return Object(r.a)(function*(){let r,n=Object(s.a)(e);const a=n.outSR;try{n=yield i._schedule(()=>Object(v.d)(n,i.definitionExpression,i.spatialReference),t),n=yield i._reschedule(()=>i._checkQuerySupport(n),t),n.returnGeometry=!0,n.returnCentroid=!1,n.outSR=null,r=yield i._reschedule(()=>i._executeGeometryQuery(n,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(n),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(n),t),r=yield i._reschedule(()=>r.executeTimeQuery(n),t),r=yield i._reschedule(()=>r.executeAttributesQuery(n),t);const e=r.size;if(!e)return{count:e,extent:null};Object(g.j)(Y,g.a),i.featureStore.forEachBounds(r.items,e=>Object(g.e)(Y,e),L);const s={xmin:Y[0],ymin:Y[1],xmax:Y[3],ymax:Y[4],spatialReference:Object(v.b)(i.spatialReference)};i.hasZ&&isFinite(Y[2])&&isFinite(Y[5])&&(s.zmin=Y[2],s.zmax=Y[5]);const u=Object(b.b)(s,r.spatialReference,a);if(u.spatialReference=Object(v.b)(a||i.spatialReference),u.xmax-u.xmin==0){const e=Object(l.d)(u.spatialReference);u.xmin-=e,u.xmax+=e}if(u.ymax-u.ymin==0){const e=Object(l.d)(u.spatialReference);u.ymin-=e,u.ymax+=e}if(i.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0){const e=Object(l.d)(u.spatialReference);u.zmin-=e,u.zmax+=e}return{count:e,extent:u}}catch(u){if(u===v.a)return{count:0,extent:null};throw u}})()}executeQueryForIds(e={},t){var i=this;return Object(r.a)(function*(){return i.executeQueryForIdSet(e,t).then(e=>Array.from(e))})()}executeQueryForIdSet(e={},t){var i=this;return Object(r.a)(function*(){let r,n=Object(s.a)(e);n.returnGeometry=!1,n.returnCentroid=!1,n.outSR=null;try{n=yield i._schedule(()=>Object(v.d)(n,i.definitionExpression,i.spatialReference),t),n=yield i._reschedule(()=>i._checkQuerySupport(n),t),r=yield i._reschedule(()=>i._executeGeometryQuery(n,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(n),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(n),t),r=yield i._reschedule(()=>r.executeTimeQuery(n),t),r=yield i._reschedule(()=>r.executeAttributesQuery(n),t);const e=r.items,s=new Set;return yield i._reschedule(()=>{for(const t of e)s.add(r.featureAdapter.getObjectId(t))},t),s}catch(a){if(a===v.a)return new Set;throw a}})()}executeQueryForSnapping(e,t){var i=this;return Object(r.a)(function*(){const{point:r,distance:s,types:a}=e;if(0===a)return{candidates:[]};const c=yield i._reschedule(()=>i._checkQuerySupport(e.query),t),l=!Object(u.c)(r.spatialReference,i.spatialReference);l&&(yield Object(b.a)(r.spatialReference,i.spatialReference));const h="number"==typeof s?s:s.x,f="number"==typeof s?s:s.y,y={xmin:r.x-h,xmax:r.x+h,ymin:r.y-f,ymax:r.y+f,spatialReference:r.spatialReference},p=l?Object(b.b)(y,i.spatialReference):y;if(!p)return{candidates:[]};const m=(yield Object(d.a)(Object(o.a)(r),null,{signal:t}))[0],g=(yield Object(d.a)(Object(o.a)(p),null,{signal:t}))[0];if(Object(n.h)(m)||Object(n.h)(g))return{candidates:[]};let x=new z(i._searchFeatures(i._getQueryBBoxes(g.toJSON())),null,i);x=yield i._reschedule(()=>x.executeObjectIdsQuery(c),t),x=yield i._reschedule(()=>x.executeTimeQuery(c),t),x=yield i._reschedule(()=>x.executeAttributesQuery(c),t);const _=m.toJSON(),I=l?Object(b.b)(_,i.spatialReference):_,O=l?Math.max(p.xmax-p.xmin,p.ymax-p.ymin)/2:s;return x.createSnappingResponse({...e,point:I,distance:O},r.spatialReference)})()}executeQueryForLatestObservations(e={},t){var i=this;return Object(r.a)(function*(){if(!i.timeInfo||!i.timeInfo.trackIdField)throw new a.a(Z,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:i.timeInfo});let r,n=Object(s.a)(e);try{n=yield i._schedule(()=>Object(v.d)(n,i.definitionExpression,i.spatialReference),t),n=yield i._reschedule(()=>i._checkQuerySupport(n),t),r=yield i._reschedule(()=>i._executeGeometryQuery(n,t),t),r=yield i._reschedule(()=>r.executeAggregateIdsQuery(n),t),r=yield i._reschedule(()=>r.executeObjectIdsQuery(n),t),r=yield i._reschedule(()=>r.executeTimeQuery(n),t),r=yield i._reschedule(()=>r.executeAttributesQuery(n),t),r=yield i._reschedule(()=>r.filterLatest(),t)}catch(u){if(u!==v.a)throw u;r=new z([],null,i)}return r.createQueryResponse(n)})()}_schedule(e,t){var i=this;return Object(r.a)(function*(){return i._frameQueue?i._frameQueue.push(e,t):e()})()}_reschedule(e,t){var i=this;return Object(r.a)(function*(){return i._frameQueue?i._frameQueue.unshift(e,t):e()})()}_update(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const e=[];this.featureStore.forEach(t=>e.push(t)),this._allItems=new z(e,null,this)}return this._allItems}_executeGeometryQuery(e,t){var i=this;return Object(r.a)(function*(){const{geometry:s,outSR:a,spatialRel:c,returnGeometry:o,returnCentroid:l}=e,h=o||l,f=Object(u.i)(a)&&!Object(u.c)(i.spatialReference,a),d=i._geometryQueryCache?f&&h?JSON.stringify({geometry:s,spatialRelationship:c,outSpatialReference:a}):JSON.stringify({geometry:s,spatialRelationship:c}):null;if(d){const e=i._geometryQueryCache.get(d);if(!Object(n.j)(e))return e}const y=function(){var e=Object(r.a)(function*(e){if(f&&h){const t=yield e.project(a);return d&&i._geometryQueryCache.put(d,t,t.size||1),t}return d&&i._geometryQueryCache.put(d,e,e.size||1),e});return function(t){return e.apply(this,arguments)}}();if(!s)return y(i._getAll());const p=i.featureAdapter;if("esriSpatialRelDisjoint"===c){const e=i._searchFeatures(i._getQueryBBoxes(s));if(!e.length)return y(i._getAll());let n,a;const u=new Set;for(const t of e)u.add(p.getObjectId(t));return yield i._reschedule(()=>{let e=0;n=new Array(u.size),i.featureStore.forEach(t=>n[e++]=t),a=u},t),y(yield i._reschedule(Object(r.a)(function*(){const e=yield Object(Q.c)(c,s,i.geometryType,i.hasZ,i.hasM);return new z(yield i._runSpatialFilter(n,t=>!a.has(p.getObjectId(t))||e(p.getGeometry(t)),t),s,i)}),t))}const m=i._searchFeatures(i._getQueryBBoxes(s));if(!m.length){const e=new z([],s,i);return d&&i._geometryQueryCache.put(d,e,e.size||1),e}if(i._canExecuteSoloPass(s,e))return y(new z(m,s,i));const g=yield Object(Q.c)(c,s,i.geometryType,i.hasZ,i.hasM),b=yield i._runSpatialFilter(m,e=>g(p.getGeometry(e)),t);return y(new z(b,s,i))})()}_runSpatialFilter(e,t,i){var s=this;return Object(r.a)(function*(){if(!t)return e;if(!s._budget)return e.filter(e=>t(e));let n=0;const a=new Array,u=function(){var c=Object(r.a)(function*(){for(;n<e.length;){const r=e[n];t(r)&&a.push(r),s._budget.done&&(yield s._reschedule(()=>u(),i)),++n}});return function(){return c.apply(this,arguments)}}();return s._reschedule(()=>u(),i).then(()=>a)})()}_canExecuteSoloPass(e,t){const{geometryType:i}=this,{spatialRel:r}=t;return Object(Q.a)(e)&&("esriSpatialRelEnvelopeIntersects"===r||"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r||"esriSpatialRelWithin"===r))}_getQueryBBoxes(e){if(Object(Q.a)(e)){if(Object(o.d)(e))return[Object(h.j)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(o.g)(e))return e.rings.map(e=>Object(h.j)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1])))}return[Object(c.a)(Object(h.e)(),e)]}_searchFeatures(e){for(const r of e)this.featureStore.forEachInBounds(r,e=>{k.add(e)});const t=new Array(k.size);let i=0;return k.forEach(e=>t[i++]=e),k.clear(),t}_checkQuerySupport(e){var t=this;return Object(r.a)(function*(){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new a.a(Z,"Unsupported query options",{query:e});return Promise.all([t._checkAttributesQuerySupport(e),t._checkStatisticsQuerySupport(e),Object(Q.b)(e,t.geometryType,t.spatialReference),Object(b.a)(t.spatialReference,e.outSR)]).then(()=>e)})()}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:i,returnDistinctValues:r,outStatistics:s}=e,n=s?s.map(e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()):[];if(i&&i.length>0){const e=" asc",t=" desc",r=i.map(i=>{const r=i.toLowerCase();return r.indexOf(e)>-1?r.split(e)[0]:r.indexOf(t)>-1?r.split(t)[0]:i}).filter(e=>-1===n.indexOf(e));F(this.fieldsIndex,r,"orderByFields contains missing fields")}if(t&&t.length>0)F(this.fieldsIndex,t,"outFields contains missing fields");else if(r)throw new a.a(Z,"outFields should be specified for returnDistinctValues",{query:e});!function(e,t){if(!t)return!0;const i=I.get(t,e);if(!i)throw new a.a(O,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new a.a(O,"where clause is not standard",{where:t});F(e,i.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){var t=this;return Object(r.a)(function*(){const{outStatistics:i,groupByFieldsForStatistics:r,having:s}=e,n=r&&r.length,u=i&&i.length;if(s){if(!n||!u)throw new a.a(Z,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});!function(e,t,i){if(!t)return!0;const r=I.get(t,e);if(!r)throw new a.a(O,"invalid SQL expression",{having:t});if(!r.isAggregate)throw new a.a(O,"having does not contain a valid aggregate function",{having:t});if(F(e,r.fieldNames,"having contains missing fields"),!r.getExpressions().every(t=>{const{aggregateType:r,field:s}=t,n=e.has(s)&&e.get(s).name;return i.some(t=>{const{onStatisticField:i,statisticType:s}=t;return(e.has(i)&&e.get(i).name)===n&&s.toLowerCase().trim()===r})}))throw new a.a(O,"expressions in having should also exist in outStatistics",{having:t})}(t.fieldsIndex,s,i)}if(u){if(!function(e){return e.every(e=>"exceedslimit"!==e.statisticType)}(i))return;const s=i.map(e=>e.onStatisticField);F(t.fieldsIndex,s,"onStatisticFields contains missing fields"),n&&F(t.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields");for(const r of i){const{onStatisticField:i,statisticType:s}=r;if("percentile_disc"!==s&&"percentile_cont"!==s||!("statisticParameters"in r)){if("count"!==s&&i&&A(i,t.fieldsIndex))throw new a.a(Z,"outStatistics contains non-numeric fields",{definition:r,query:e})}else{const{statisticParameters:t}=r;if(!t)throw new a.a(Z,"statisticParamters should be set for percentile type",{definition:r,query:e})}}}})()}}},q7ja:function(e,t,i){"use strict";function r(e,t){if(!e)return null;const i=t.featureAdapter,{startTimeField:r,endTimeField:s}=e;let n=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(r&&s)t.forEach(e=>{const t=i.getAttribute(e,r),u=i.getAttribute(e,s);null==t||isNaN(t)||(n=Math.min(n,t)),null==u||isNaN(u)||(a=Math.max(a,u))});else{const e=r||s;t.forEach(t=>{const r=i.getAttribute(t,e);null==r||isNaN(r)||(n=Math.min(n,r),a=Math.max(a,r))})}return{start:n,end:a}}function s(e,t,i){if(!t||!e)return null;const{startTimeField:r,endTimeField:s}=e;if(!r&&!s)return null;const{start:n,end:a}=t;return null===n&&null===a?null:void 0===n&&void 0===a?()=>!1:r&&s?function(e,t,i,r,s){return null!=r&&null!=s?n=>{const a=e.getAttribute(n,t),u=e.getAttribute(n,i);return(null==a||a<=s)&&(null==u||u>=r)}:null!=r?t=>{const s=e.getAttribute(t,i);return null==s||s>=r}:null!=s?i=>{const r=e.getAttribute(i,t);return null==r||r<=s}:void 0}(i,r,s,n,a):function(e,t,i,r){return null!=i&&null!=r&&i===r?r=>e.getAttribute(r,t)===i:null!=i&&null!=r?s=>{const n=e.getAttribute(s,t);return n>=i&&n<=r}:null!=i?r=>e.getAttribute(r,t)>=i:null!=r?i=>e.getAttribute(i,t)<=r:void 0}(i,r||s,n,a)}i.d(t,"a",function(){return r}),i.d(t,"b",function(){return s})}}]);